<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Pusat Game Offline</title>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
            background: #0f172a; font-family: 'Segoe UI', sans-serif; color: #fff;
            padding-top: env(safe-area-inset-top);
        }
        #main-container { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        h1 { font-size: 24px; color: #38bdf8; margin: 0 0 10px 0; }
        .menu-selection { margin-bottom: 15px; display: flex; gap: 10px; }
        select { padding: 8px; border-radius: 5px; background: #1e293b; color: white; border: 1px solid #38bdf8; }
        
        /* Menu Utama */
        #game-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; width: 100%; }
        .menu-card { background: #1e293b; padding: 20px; border-radius: 15px; text-align: center; cursor: pointer; border: 2px solid transparent; transition: 0.3s; }
        .menu-card:active { border-color: #38bdf8; transform: scale(0.95); }
        .menu-card span { font-size: 40px; display: block; margin-bottom: 10px; }

        /* Layar Game */
        .game-screen { display: none; flex-direction: column; align-items: center; width: 100%; height: 100%; justify-content: center; padding: 20px; }
        .active { display: flex; }

        /* Canvas & Board */
        canvas { background: #1e293b; border-radius: 15px; border: 2px solid #334155; max-width: 90vw; max-height: 45vh; }
        .board { display: grid; grid-template-columns: repeat(3, 85px); grid-template-rows: repeat(3, 85px); gap: 10px; background: #1e293b; padding: 15px; border-radius: 15px; position: relative; }
        .cell { background: #334155; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 35px; font-weight: bold; height: 85px; }
        .x-color { color: #38bdf8; } .o-color { color: #fb7185; }
        #winning-line { position: absolute; background: #f43f5e; display: none; z-index: 10; border-radius: 10px; pointer-events: none; }

        /* Controls */
        .snake-controls { display: grid; grid-template-columns: repeat(3, 60px); grid-template-rows: repeat(2, 60px); gap: 10px; margin-top: 15px; }
        .ctrl-btn { background: #334155; border: 2px solid #38bdf8; color: white; border-radius: 12px; font-size: 24px; display: flex; align-items: center; justify-content: center; height: 60px; }
        .up { grid-column: 2; } .left { grid-column: 1; grid-row: 2; } .down { grid-column: 2; grid-row: 2; } .right { grid-column: 3; grid-row: 2; }

        /* UI Math */
        .math-box { background: #1e293b; padding: 20px; border-radius: 15px; text-align: center; border: 2px solid #38bdf8; width: 280px; }
        #math-ans { width: 100%; padding: 10px; font-size: 24px; border-radius: 8px; border: none; text-align: center; background: #334155; color: white; margin-top: 10px; }
        
        .status { margin: 10px 0; font-size: 16px; color: #94a3b8; }
        .lives { color: #fb7185; font-size: 20px; margin-bottom: 5px; }
        button { padding: 12px 20px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-back { background: #ef4444; color: white; width: 200px; margin-top: 15px; }
        .btn-reset { background: #334155; color: white; }
        .btn-start { background: #10b981; color: white; font-size: 18px; }
    </style>
</head>
<body>

<div id="main-container">
    <div id="game-menu" class="game-screen active" style="display: grid;">
        <h1 style="grid-column: span 2; text-align: center;">OFFLINE GAMES</h1>
        <div class="menu-card" onclick="showGame('ttt')"><span>‚ùå‚≠ï</span>Tic Tac Toe</div>
        <div class="menu-card" onclick="showGame('snake')"><span>üêç</span>Snake</div>
        <div class="menu-card" onclick="showGame('math')"><span>‚ûï</span>Math Quiz</div>
        <div class="menu-card" onclick="showGame('mole')"><span>üî®</span>Whack Mole</div>
    </div>

    <div id="screen-ttt" class="game-screen">
        <h1>TIC TAC TOE</h1>
        <div class="menu-selection">
            <select id="difficulty" onchange="resetGame()">
                <option value="easy">Mudah</option><option value="medium">Sedang</option><option value="hard">Sulit</option><option value="impossible">Mustahil</option>
            </select>
        </div>
        <div class="board" id="board">
            <div id="winning-line"></div>
            <div class="cell" onclick="makeMove(0)"></div><div class="cell" onclick="makeMove(1)"></div><div class="cell" onclick="makeMove(2)"></div>
            <div class="cell" onclick="makeMove(3)"></div><div class="cell" onclick="makeMove(4)"></div><div class="cell" onclick="makeMove(5)"></div>
            <div class="cell" onclick="makeMove(6)"></div><div class="cell" onclick="makeMove(7)"></div><div class="cell" onclick="makeMove(8)"></div>
        </div>
        <div class="status" id="status">Giliran Kamu</div>
        <button class="btn-reset" onclick="resetGame()">Ulang</button>
        <button class="btn-back" onclick="goToMenu()">Menu Utama</button>
    </div>

    <div id="screen-snake" class="game-screen">
        <h1>SNAKE</h1>
        <canvas id="snakeCanvas" width="400" height="400"></canvas>
        <div id="snake-controls-ui" class="snake-controls" style="display: none;">
            <div class="ctrl-btn up" onclick="changeSnakeDir('UP')">‚ñ≤</div>
            <div class="ctrl-btn left" onclick="changeSnakeDir('LEFT')">‚óÄ</div>
            <div class="ctrl-btn down" onclick="changeSnakeDir('DOWN')">‚ñº</div>
            <div class="ctrl-btn right" onclick="changeSnakeDir('RIGHT')">‚ñ∂</div>
        </div>
        <div id="snake-start-btn" style="margin-top: 10px;">
            <button class="btn-start" onclick="startSnakeLoop()">MULAI GAME</button>
        </div>
        <div class="status" id="snake-status">Skor: 0</div>
        <button class="btn-back" onclick="goToMenu()">Menu Utama</button>
    </div>

    <div id="screen-math" class="game-screen">
        <h1>MATH QUIZ</h1>
        <div id="math-lives" class="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
        <div class="math-box">
            <div id="math-q" style="font-size: 30px;">?</div>
            <input type="number" id="math-ans" placeholder="Jawab...">
        </div>
        <div class="status" id="math-status">Skor: 0</div>
        <button class="btn-back" onclick="goToMenu()">Menu Utama</button>
    </div>

    <div id="screen-mole" class="game-screen">
        <h1>WHACK A MOLE</h1>
        <div id="mole-lives" class="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
        <div class="menu-selection">
            <select id="mole-level" onchange="initMole()">
                <option value="1200">Mudah</option><option value="800" selected>Sedang</option><option value="500">Sulit</option>
            </select>
        </div>
        <canvas id="moleCanvas" width="300" height="300"></canvas>
        <div class="status" id="mole-status">Skor: 0</div>
        <button class="btn-back" onclick="goToMenu()">Menu Utama</button>
    </div>
</div>

<script>
    /* UTILS */
    function showGame(id) {
        document.querySelectorAll('.game-screen').forEach(s => { s.classList.remove('active'); s.style.display = 'none'; });
        const target = document.getElementById('screen-' + id);
        target.classList.add('active'); target.style.display = 'flex';
        document.getElementById('game-menu').style.display = 'none';
        if(id === 'snake') initSnake();
        if(id === 'math') resetMath();
        if(id === 'mole') initMole();
    }
    function goToMenu() { location.reload(); }

    /* 1. TIC TAC TOE */
    let tttBoard = ["","","","","","","","",""];
    let gameActive = true;
    const winConditions = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

    function makeMove(idx) {
        if(tttBoard[idx] === "" && gameActive) {
            tttBoard[idx] = "X"; updateTTT();
            if(!checkWinTTT("X") && tttBoard.includes("")) setTimeout(aiTTT, 400);
        }
    }
    function aiTTT() {
        let avail = tttBoard.map((v,i) => v===""?i:null).filter(v=>v!==null);
        let move = avail[Math.floor(Math.random()*avail.length)];
        tttBoard[move] = "O"; updateTTT(); checkWinTTT("O");
    }
    function updateTTT() {
        const cells = document.querySelectorAll('#screen-ttt .cell');
        tttBoard.forEach((v,i) => { cells[i].innerText = v; cells[i].className = `cell ${v==='X'?'x-color':(v==='O'?'o-color':'')}`; });
    }
    function checkWinTTT(p) {
        let win = winConditions.some(c => c.every(i => tttBoard[i] === p));
        if(win) { document.getElementById('status').innerText = p==="X"?"Menang!":"Kalah!"; gameActive = false; return true; }
        if(!tttBoard.includes("")) { document.getElementById('status').innerText = "Seri!"; return true; }
        return false;
    }
    function resetGame() { tttBoard.fill(""); gameActive = true; document.getElementById('status').innerText = "Giliran Kamu"; updateTTT(); }

    /* 2. SNAKE */
    let snake, food, snakeDir, snakeLoop, sScore;
    function initSnake() {
        clearInterval(snakeLoop);
        const ctx = document.getElementById('snakeCanvas').getContext('2d');
        snake = [{x:200, y:200}]; food = {x:100, y:100}; snakeDir = "RIGHT"; sScore = 0;
        document.getElementById('snake-status').innerText = "Skor: 0";
        document.getElementById('snake-start-btn').style.display = "block";
        document.getElementById('snake-controls-ui').style.display = "none";
        ctx.fillStyle = "#1e293b"; ctx.fillRect(0,0,400,400);
        ctx.fillStyle = "#38bdf8"; ctx.fillRect(200,200,19,19);
    }
    function changeSnakeDir(d) { 
        if(d==="UP"&&snakeDir!=="DOWN") snakeDir="UP"; if(d==="DOWN"&&snakeDir!=="UP") snakeDir="DOWN";
        if(d==="LEFT"&&snakeDir!=="RIGHT") snakeDir="LEFT"; if(d==="RIGHT"&&snakeDir!=="LEFT") snakeDir="RIGHT";
    }
    function startSnakeLoop() {
        document.getElementById('snake-start-btn').style.display = "none";
        document.getElementById('snake-controls-ui').style.display = "grid";
        const ctx = document.getElementById('snakeCanvas').getContext('2d');
        snakeLoop = setInterval(() => {
            let head = {...snake[0]};
            if(snakeDir==="UP") head.y-=20; if(snakeDir==="DOWN") head.y+=20;
            if(snakeDir==="LEFT") head.x-=20; if(snakeDir==="RIGHT") head.x+=20;
            if(head.x<0||head.x>=400||head.y<0||head.y>=400||snake.some(s=>s.x===head.x&&s.y===head.y)) {
                clearInterval(snakeLoop); alert("Game Over! Skor: "+sScore); initSnake(); return;
            }
            snake.unshift(head);
            if(head.x===food.x && head.y===food.y) {
                sScore++; document.getElementById('snake-status').innerText = "Skor: "+sScore;
                food = {x: Math.floor(Math.random()*19)*20, y: Math.floor(Math.random()*19)*20};
            } else snake.pop();
            ctx.fillStyle = "#1e293b"; ctx.fillRect(0,0,400,400);
            ctx.fillStyle = "#fb7185"; ctx.fillRect(food.x, food.y, 19, 19);
            snake.forEach((s,i) => { ctx.fillStyle = i===0?"#38bdf8":"#94a3b8"; ctx.fillRect(s.x, s.y, 19, 19); });
        }, 150);
    }

    /* 3. MATH */
    let mAns, mScore, mLives;
    function resetMath() { mScore=0; mLives=5; updateML(); nextMath(); }
    function updateML() {
        let h = ""; for(let i=0; i<mLives; i++) h+="‚ù§Ô∏è";
        document.getElementById('math-lives').innerText = h || "KALAH!";
        document.getElementById('math-status').innerText = "Skor: " + mScore;
    }
    function nextMath() {
        let ops = ['+','-','*','/']; let op = ops[Math.floor(Math.random()*4)];
        let a = Math.floor(Math.random()*20)+1, b = Math.floor(Math.random()*10)+1;
        if(op==='/') { a = b * (Math.floor(Math.random()*10)+1); mAns = a/b; }
        else if(op==='*') mAns = a*b; else if(op==='-') { a=a+b; mAns = a-b; } else mAns = a+b;
        document.getElementById('math-q').innerText = `${a} ${op==='*'?'√ó':op==='/'?'√∑':op} ${b} = ?`;
        document.getElementById('math-ans').value = "";
    }
    document.getElementById('math-ans').oninput = function() {
        if(this.value.length >= mAns.toString().length) {
            if(parseInt(this.value) === mAns) { mScore++; nextMath(); } 
            else { mLives--; if(mLives<=0) { alert("Game Over!"); resetMath(); } else nextMath(); }
            updateML();
        }
    };

    /* 4. WHACK MOLE */
    let moleData = [], moleScore, moleLives, moleLoop;
    function initMole() {
        clearInterval(moleLoop); moleScore = 0; moleLives = 5;
        document.getElementById('mole-status').innerText = "Skor: 0"; updateMoleL();
        const ctx = document.getElementById('moleCanvas').getContext('2d');
        const speed = document.getElementById('mole-level').value;
        moleLoop = setInterval(() => {
            moleData = new Array(9).fill(null);
            let rIdx = Math.floor(Math.random()*9); moleData[rIdx] = "BUNNY";
            let cCount = speed < 600 ? 4 : (speed < 900 ? 2 : 1);
            for(let i=0; i<cCount; i++) {
                let cIdx = Math.floor(Math.random()*9);
                if(!moleData[cIdx]) moleData[cIdx] = "CARROT";
            }
            drawMole(ctx);
        }, speed);
    }
    function updateMoleL() {
        let h = ""; for(let i=0; i<moleLives; i++) h+="‚ù§Ô∏è";
        document.getElementById('mole-lives').innerText = h;
    }
    function drawMole(ctx) {
        ctx.fillStyle = "#1e293b"; ctx.fillRect(0,0,300,300);
        ctx.font = "40px Arial";
        for(let i=0; i<9; i++) {
            ctx.strokeStyle = "#334155"; ctx.strokeRect((i%3)*100, Math.floor(i/3)*100, 100, 100);
            if(moleData[i]==="BUNNY") ctx.fillText("üê∞", (i%3)*100+25, Math.floor(i/3)*100+65);
            if(moleData[i]==="CARROT") ctx.fillText("ü•ï", (i%3)*100+25, Math.floor(i/3)*100+65);
        }
    }
    document.getElementById('moleCanvas').onclick = function(e) {
        const rect = this.getBoundingClientRect();
        const x = (e.clientX - rect.left) * (300/rect.width), y = (e.clientY - rect.top) * (300/rect.height);
        const idx = Math.floor(y/100)*3 + Math.floor(x/100);
        if(moleData[idx]==="BUNNY") { moleScore++; document.getElementById('mole-status').innerText = "Skor: "+moleScore; moleData[idx]=null; drawMole(this.getContext('2d')); }
        else if(moleData[idx]==="CARROT") { moleLives=0; updateMoleL(); alert("Kena Wortel! Game Over!"); initMole(); }
    };
</script>
</body>
</html>
